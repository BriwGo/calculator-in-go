# 🏦 Bank - Банковское приложение на Go

Многопоточное банковское приложение на Go, демонстрирующее работу с **горутинами**, **мьютексами** и **синхронизацией**.

## 📋 Описание проекта

Приложение эмулирует работу банковских операций с несколькими пользователями, выполняющимися **параллельно**. Каждый пользователь:
- ✅ Проверяет баланс
- 💰 Совершает платежи (с вероятностью сбоя сети 30%)
- 📈 Пополняет счёт
- 🎲 Генерирует случайные числа (выход из программы при определённых значениях)

## 🛠 Технологические особенности

### Горутины (Goroutines)
4 параллельные горутины работают одновременно, каждая с собственным пользователем банка.

### Мьютексы (Mutex)
Защита общих данных (баланса) от race conditions:
```go
l.mu.Lock()           // Захватить блокировку
defer l.mu.Unlock()   // Освободить блокировку
```

### WaitGroup
Синхронизация завершения всех горутин:
```go
wg.Wait() // Ждём, пока все горутины закончат работу
```

## 📁 Структура проекта

```
Bank/
├── main.go                 # Основная программа с горутинами
├── go.mod                  # Модуль Go (banking)
├── README.md              # Этот файл
└── src/
    ├── main.go            # Альтернативная точка входа
    ├── go.mod
    └── app/
        ├── logic.go       # Структура Storage и методы
        └── errors.go      # Переменные ошибок
```

## 🚀 Запуск программы

### Требования
- Go 1.25.1 или выше
- Windows/Linux/macOS

### Вариант 1: Из корневой папки
```powershell
cd "D:\NewEra\STUDYTWO\calculator in go\Bank"
go run main.go
```

### Вариант 2: Из папки src
```powershell
cd "D:\NewEra\STUDYTWO\calculator in go\Bank\src"
go run main.go
```

## 📊 Пример вывода

```
═══════════════════════════════════════════════════════════
ЗАПУСК ПАРАЛЛЕЛЬНОГО ВЫПОЛНЕНИЯ 4 ГОРУТИН
═══════════════════════════════════════════════════════════
[ПОЛЬЗОВАТЕЛЬ 1] Начало работы
[ПОЛЬЗОВАТЕЛЬ 1] Текущий баланс: 200
[ПОЛЬЗОВАТЕЛЬ 1] Платёж выполнен
[ПОЛЬЗОВАТЕЛЬ 1] Счёт пополнен
[ПОЛЬЗОВАТЕЛЬ 2] Начало работы
[ПОЛЬЗОВАТЕЛЬ 2] Текущий баланс: 2300
[ПОЛЬЗОВАТЕЛЬ 2] Ошибка платежа: Network error, please try again later
...
[ПОЛЬЗОВАТЕЛЬ 1] 🎉 ВЫПАЛО ЧИСЛО: 42
[ПОЛЬЗОВАТЕЛЬ 1] Завершен! Время выполнения: 5.234s
...
═══════════════════════════════════════════════════════════
ВСЕ ГОРУТИНЫ ЗАВЕРШЕНЫ! ОБЩЕЕ ВРЕМЯ ВЫПОЛНЕНИЯ: 8.567s
═══════════════════════════════════════════════════════════
```

## 🔧 Компоненты

### Storage (структура данных)
```go
type Storage struct {
    mu      sync.Mutex  // Мьютекс для защиты
    ID      int         // Уникальный ID
    Name    string      // Имя пользователя
    Balance int         // Баланс счёта
}
```

### Методы Storage

#### GetBalance() - Получить баланс
```go
balance, err := storage.GetBalance()
```
Потокобезопасное чтение баланса.

#### Pay(amount) - Снять деньги
```go
err := storage.Pay(50)
```
- Проверяет сетевую ошибку (30% вероятность)
- Проверяет достаточность средств
- Снимает деньги если всё OK

#### Deposit(amount) - Пополнить счёт
```go
err := storage.Deposit(100)
```
- Проверяет положительность суммы
- Пополняет баланс

## ⚠️ Обработка ошибок

### Возможные ошибки:
| Ошибка | Описание |
|--------|---------|
| `NetworkError` | Ошибка сети при платеже (случайная, 30%) |
| `insufficientFunds` | Недостаточно средств для платежа |
| `WhatTheFuck` | Попытка пополнения на отрицательную сумму |

## 📚 Обучающие концепции

### 1. Горутины
Лёгкие потоки в Go, работающие одновременно:
```go
go GorutuneDemo(newUser, 1, &wg)
```

### 2. WaitGroup
Синхронизация горутин:
```go
var wg sync.WaitGroup
wg.Add(1)           // Добавить горутину в счётчик
defer wg.Done()     // Уменьшить счётчик при завершении
wg.Wait()           // Ждать завершения всех
```

### 3. Mutex (Взаимное исключение)
Защита от race conditions:
```go
mu.Lock()           // Захватить
defer mu.Unlock()   // Гарантированное освобождение
```

## 🎯 Числа-триггеры

При выпадении следующих чисел горутина завершается:
- **0** - Ноль
- **1** - Единица
- **3** - Три
- **7** - Семь
- **13** - Чёрная кошка
- **42** - Ответ на вопрос
- **52** - Избранное число
- **67** - Специальное число
- **99** - Почти сто
- **666** - Адское число

## 🧪 Тестирование

Для проверки работы мьютексов можно использовать:
```bash
go run -race main.go
```
Флаг `-race` обнаруживает race conditions (конфликты доступа).

## 📝 Лицензия

Образовательный проект. Свободен для использования в учебных целях.

## 👨‍💻 Автор

Написано как учебный проект для изучения горутин и мьютексов в Go.

---

**Версия:** 1.0  
**Go версия:** 1.25.1  
**Дата создания:** Январь 2026